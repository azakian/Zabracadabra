<div class="modal-overlay" (click)="onClose()" (keydown)="onClose()" aria-hidden="true">
  <div
    aria-hidden="true"
    class="modal-content"
    (keydown)="$event.stopPropagation()"
    (click)="$event.stopPropagation()"
    role="dialog"
    aria-labelledby="payment-title"
  >
    <header class="modal-header">
      <h2 id="payment-title">Paiement par carte</h2>
      <button
        type="button"
        class="close-btn"
        (click)="onClose()"
        aria-label="Fermer la fenêtre de paiement"
      >
        ×
      </button>
    </header>

    <form class="payment-form" (submit)="onConfirm()">
      <div class="form-group">
        <label for="card-number">Numéro de carte</label>
        <input
          id="card-number"
          type="text"
          class="form-input"
          placeholder="1234 5678 9012 3456"
          [field]="paymentForm.cardNumber"
          [class.is-invalid]="
            paymentForm.cardNumber().touched() && paymentForm.cardNumber().invalid()
          "
          [class.is-valid]="paymentForm.cardNumber().touched() && paymentForm.cardNumber().valid()"
          autocomplete="cc-number"
        />
      </div>

      <div class="form-group">
        <label for="card-holder">Titulaire de la carte</label>
        <input
          id="card-holder"
          type="text"
          class="form-input"
          placeholder="JEAN DUPONT"
          [field]="paymentForm.cardHolder"
          [class.is-invalid]="
            paymentForm.cardHolder().touched() && paymentForm.cardHolder().invalid()
          "
          [class.is-valid]="paymentForm.cardHolder().touched() && paymentForm.cardHolder().valid()"
          autocomplete="cc-name"
        />
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="expiry-date">Date d'expiration</label>
          <input
            id="expiry-date"
            type="text"
            class="form-input"
            placeholder="MM/AA"
            [field]="paymentForm.expiryDate"
            [class.is-invalid]="
              paymentForm.expiryDate().touched() && paymentForm.expiryDate().invalid()
            "
            [class.is-valid]="
              paymentForm.expiryDate().touched() && paymentForm.expiryDate().valid()
            "
            (input)="formatExpiryDate($event)"
            autocomplete="cc-exp"
          />
        </div>

        <div class="form-group">
          <label for="cvv">CVV</label>
          <input
            id="cvv"
            type="text"
            class="form-input"
            placeholder="123"
            [field]="paymentForm.cvv"
            [class.is-invalid]="paymentForm.cvv().touched() && paymentForm.cvv().invalid()"
            [class.is-valid]="paymentForm.cvv().touched() && paymentForm.cvv().valid()"
            autocomplete="cc-csc"
          />
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="cancel-btn" (click)="onClose()">Annuler</button>
        <button type="submit" class="pay-btn" [disabled]="paymentForm().invalid()">Payer</button>
      </div>
    </form>
  </div>
</div>
